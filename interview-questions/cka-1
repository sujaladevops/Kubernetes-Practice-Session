1.Create a new ClusterRole named deployment-clusterrole, which only allows to create the following resource types:
✑ Deployment
✑ Stateful Set
✑ DaemonSet
Create a new ServiceAccount named cicd-token in the existing namespace app-team1.
Bind the new ClusterRole deployment-clusterrole to the new ServiceAccount cicd-token, limited to the namespace app-team1.
Ans:

kubectl config use-context k8s
kubectl create clusterrole deployment-clusterrole --verb=create --resource=deployments,statefulsets,daemonsets -n app-team1
kubectl create sa cicd-token --namespace app-team1
kubectl create clusterrolebinding deploy-b --clusterrole=deployment-clusterrole --serviceaccount=app-team1:cicd-token

2. Set the node named ek8s-node-0 as unavailable and reschedule all the pods running on it.
kubectl config use-context ek8s
k get nodes
NAME            STATUS        ROLES              AGE       VERSION
ek8s-master-0    READY    control-plane,master   67d       v1.23.1
ek8s-node-0      READY       <none>              67d       v1.23.1
ek8s-node-1      READY       <none>              67d       v1.23.1

kubectl cordon ek8s-node-0 (may or may not need it)
k drain ek8s-node0 --ignore-daemonsets
k drain ek8s-node0 --ignore-daemonsets --delete-emptydir-data/k drain ek8s-node-0 --delete-local-data --ignore-daemonsets --force
k get nodes
k get pods -o wide


3. Given an existing Kubernetes cluster running version 1.22.1, upgrade all of the Kubernetes control plane and node components on the master
node only to version 1.22.2.
Be sure to drain the master node before upgrading it and uncordon it after the upgrade.
You are also expected to upgrade kubelet and kubectl on the master node.
You can ssh to the master node using:
ssh k8s-master-0
You can assume elevated privileges on the master ndoe with the following command:
sudo -i
NOTE: Do not upgrade the worker nodes, etcd, the container manager, the CNI plugin, the DNS service or any other addons.

Ans:
k config use-context mk8s
k get nodes
mk8s-master-0     Ready      Control-plane, master     v1.22.1
mk8s-node-0       Ready      <none>                    v1.22.1
k drainmk8s-master-0 --ignore-daemonsets (cordoned)
k get nodes
ssh mk8s-master-0
sudo -i
root@mk8s-master-0:-apt install kubeadm=1.22.2-00 kubelet=1.22.2-00 kubectl=1.22.2-00
root@mk8s-master-0:-apt install kubeadm=1.22.2-00 kubelet=1.22.2-00 kubectl=1.22.2-00
root@mk8s-master-0:-kubeadm upgrade plan
root@mk8s-master-0:-kubeadm upgrade apply v1.22.2
root@mk8s-master-0:-systemctl restart kubelet
root@mk8s-master-0:-exit
student@node-1:-kubectl uncordon mk8s-master-0 (uncordoned)
k get nodes
mk8s-master-0     Ready      Control-plane, master     v1.22.2
mk8s-node-0       Ready      <none>                    v1.22.1